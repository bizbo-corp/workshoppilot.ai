# Phase 13.1: Reset Step & Step 8 Ideation Sub-Steps - Research

**Researched:** 2026-02-10
**Domain:** Server-side state management, cascade invalidation, UI component architecture, step navigation
**Confidence:** HIGH

## Summary

Phase 13.1 adds two independent features: (1) Reset Step functionality that clears conversation/artifact/summary for the current step with cascade invalidation, and (2) internal sub-step navigation for Step 8 Ideation (8a Mind Mapping, 8b Crazy 8s, 8c Brain Writing) while preserving the 10-step mental model. Both features build on existing architecture patterns from Phase 10 (cascade invalidation) and Phase 13 (Step 8 ideation flow). Research confirms the codebase already has the necessary primitives: cascade invalidation service, server actions, confirmation dialogs, and step-specific UI components. The key technical decision is whether Step 8 sub-steps should expand step-metadata from 10 to 12 steps OR use internal sub-step state within a single Step 8 container.

**Primary recommendation:** Implement Reset Step as a new server action leveraging existing cascade invalidation. For Step 8 sub-steps, use internal state management within the existing Step 8 container (preserving 10-step model) with a tabbed UI pattern from shadcn/ui.

## Current Architecture Context

### Cascade Invalidation (Phase 10)

The codebase already has a robust cascade invalidation system implemented in Phase 10 Plan 2:

**File:** `/Users/michaelchristie/devProjects/workshoppilot.ai/src/lib/navigation/cascade-invalidation.ts`

```typescript
export async function invalidateDownstreamSteps(
  workshopId: string,
  revisedStepId: string
): Promise<{ invalidatedCount: number }>
```

**How it works:**
1. Finds the order of the revised step from STEPS array
2. Resets the revised step itself to `in_progress` with `arcPhase: 'orient'` and `completedAt: null`
3. Filters downstream steps (order > revisedStep.order)
4. Updates each downstream step to `needs_regeneration` status with reset timestamps
5. **Preserves artifacts and summaries** as starting points for regeneration
6. Returns count of invalidated steps

**Existing server action:** `reviseStep(workshopId, stepId, sessionId)` in `/Users/michaelchristie/devProjects/workshoppilot.ai/src/actions/workshop-actions.ts`

This is the exact mechanism needed for Reset Step — the only difference is that Reset Step also needs to clear messages, artifacts, and summaries for the current step (not just reset status).

### Database Schema for Steps

**File:** `/Users/michaelchristie/devProjects/workshoppilot.ai/src/db/schema/steps.ts`

```typescript
export const workshopSteps = pgTable('workshop_steps', {
  id: text('id').primaryKey(),
  workshopId: text('workshop_id').notNull(),
  stepId: text('step_id').notNull(), // Semantic IDs: 'challenge', 'ideation', etc.
  status: text('status', {
    enum: ['not_started', 'in_progress', 'complete', 'needs_regeneration']
  }),
  arcPhase: text('arc_phase', {
    enum: ['orient', 'gather', 'synthesize', 'refine', 'validate', 'complete']
  }),
  output: jsonb('output'), // Deprecated field, artifacts now in separate table
  startedAt: timestamp('started_at'),
  completedAt: timestamp('completed_at'),
  createdAt: timestamp('created_at'),
  updatedAt: timestamp('updated_at')
});
```

**Related tables:**
- `chat_messages`: Stores conversation history per session + stepId
- `step_artifacts`: Stores structured JSON outputs with cascade delete on workshopStepId
- `step_summaries`: Stores AI-generated summaries with cascade delete on workshopStepId

All three tables use cascade delete (`onDelete: 'cascade'`), so deleting related records is straightforward.

### Step 8 Current Implementation (Phase 13)

**Schema:** `/Users/michaelchristie/devProjects/workshoppilot.ai/src/lib/schemas/step-schemas.ts`

```typescript
export const ideationArtifactSchema = z.object({
  hmwPrompt: z.string(),
  clusters: z.array(...),        // Round 1: Cluster generation
  userIdeas: z.array(...),        // Round 2: User input
  brainWrittenIdeas: z.array(...), // Rounds 3-5: Brain writing
  crazyEightsIdeas: z.array(...),  // Round 6: Crazy 8s
  selectedIdeas: z.array(z.string()).min(1).max(4)
});
```

**Prompt:** 6-round structured flow in `/Users/michaelchristie/devProjects/workshoppilot.ai/src/lib/ai/prompts/step-prompts.ts`

```
ROUND 1: CLUSTER GENERATION
ROUND 2: USER INPUT PROMPT
ROUND 3-5: BRAIN WRITING (3 rounds)
ROUND 6: CRAZY 8s (rapid-fire)
SELECTION (end of Step 8)
```

**UI Component:** `/Users/michaelchristie/devProjects/workshoppilot.ai/src/components/workshop/ideation-cluster-view.tsx`

Renders all 6 rounds in a single view with sections for clusters, user ideas, brain writing, and Crazy 8s.

### Step Metadata System

**File:** `/Users/michaelchristie/devProjects/workshoppilot.ai/src/lib/workshop/step-metadata.ts`

```typescript
export const STEPS: StepDefinition[] = [
  { order: 1, id: 'challenge', slug: 'challenge', name: 'Challenge', ... },
  // ...
  { order: 8, id: 'ideation', slug: 'ideation', name: 'Ideation', ... },
  // ...
];

export const TOTAL_STEPS = 10;
```

Currently hardcoded to 10 steps. The system uses:
- `stepId` (semantic string like 'ideation') as the primary identifier
- `order` (1-10) for sequencing and cascade logic
- `slug` for URL routing (`/workshop/{sessionId}/step/{order}`)

**Key question for sub-steps:** Should we expand this to 12 steps (8a, 8b, 8c) OR keep 10 steps with internal sub-step state?

## Standard Stack for Implementation

### Core Components

| Library | Version | Purpose | Why Standard |
|---------|---------|---------|--------------|
| Drizzle ORM | Latest | Database operations for deletes/updates | Already used throughout codebase for all DB access |
| Next.js Server Actions | 16.1.1 | Server-side mutations with automatic revalidation | Standard pattern for all workshop state changes |
| Zustand | Latest | Client-side state management | Used for workshop state, would handle sub-step navigation state |
| shadcn/ui Tabs | Latest | Tabbed UI for sub-steps | Accessible, keyboard navigable, consistent with design system |
| shadcn/ui Dialog | Latest | Confirmation dialogs | Already used for exit workshop confirmation |

### Supporting

| Library | Version | Purpose | When to Use |
|---------|---------|---------|-------------|
| React useState | 19 | Internal sub-step tracking | If implementing sub-steps as internal state (not DB-backed) |
| next/navigation useRouter | 16.1.1 | Client-side navigation refresh | After server actions complete, to refresh UI with new status |

**Installation:**

No new packages needed — all primitives already in use. For tabs component:

```bash
npx shadcn-ui@latest add tabs
```

## Architecture Patterns

### Reset Step Server Action Pattern

Based on existing `reviseStep` action, extend with message/artifact/summary deletion:

```typescript
// src/actions/workshop-actions.ts
export async function resetStep(
  workshopId: string,
  stepId: string,
  sessionId: string
): Promise<void> {
  // 1. Get the workshopStep record
  const [workshopStepRecord] = await db
    .select()
    .from(workshopSteps)
    .where(and(
      eq(workshopSteps.workshopId, workshopId),
      eq(workshopSteps.stepId, stepId)
    ))
    .limit(1);

  if (!workshopStepRecord) throw new Error('Step not found');

  // 2. Delete related data (cascade handles FK relationships)
  await db.delete(chatMessages)
    .where(and(
      eq(chatMessages.sessionId, sessionId),
      eq(chatMessages.stepId, stepId)
    ));

  await db.delete(stepArtifacts)
    .where(eq(stepArtifacts.workshopStepId, workshopStepRecord.id));

  await db.delete(stepSummaries)
    .where(eq(stepSummaries.workshopStepId, workshopStepRecord.id));

  // 3. Call existing cascade invalidation
  await invalidateDownstreamSteps(workshopId, stepId);

  // 4. Revalidate path
  revalidatePath(`/workshop/${sessionId}`);
}
```

### Step 8 Sub-Step Architecture: Two Approaches

#### Approach A: Expand to 12 Steps (Simpler Implementation, Breaks Mental Model)

**Change STEPS array:**
```typescript
export const STEPS: StepDefinition[] = [
  { order: 1, id: 'challenge', ... },
  // ...
  { order: 7, id: 'reframe', ... },
  { order: 8, id: 'ideation-mind-mapping', slug: 'ideation-mind-mapping', name: 'Mind Mapping', ... },
  { order: 9, id: 'ideation-crazy-eights', slug: 'ideation-crazy-eights', name: 'Crazy 8s', ... },
  { order: 10, id: 'ideation-brain-writing', slug: 'ideation-brain-writing', name: 'Brain Writing', ... },
  { order: 11, id: 'concept', ... },
  { order: 12, id: 'validate', ... },
];

export const TOTAL_STEPS = 12;
```

**Pros:**
- Simpler implementation — each sub-step is a real step with its own DB record, navigation, artifact
- Existing navigation, cascade invalidation, status tracking all work without changes
- Each sub-step gets its own focused prompt (no mega-prompt)

**Cons:**
- Breaks the "10-step design thinking" mental model that's core to WorkshopPilot brand
- Sidebar shows 12 steps instead of 10 (cognitive overhead)
- URLs change from `/step/8` to `/step/8`, `/step/9`, `/step/10` for ideation sub-steps
- May confuse users who expect a 10-step journey

#### Approach B: Internal Sub-Steps with Tabs (Preserves Mental Model, More Complex)

**Keep STEPS array at 10 steps, add sub-step state to Step 8 container:**

```typescript
// src/components/workshop/step-container.tsx (Step 8 only)
const [currentSubStep, setCurrentSubStep] = useState<'mind-mapping' | 'crazy-eights' | 'brain-writing'>('mind-mapping');

// Sub-step artifacts stored in state, merged into final Step 8 artifact on completion
const [mindMappingIdeas, setMindMappingIdeas] = useState<Idea[]>([]);
const [crazyEightsIdeas, setCrazyEightsIdeas] = useState<Idea[]>([]);
const [brainWrittenIdeas, setBrainWrittenIdeas] = useState<BrainWrittenIdea[]>([]);

// Tabs UI for sub-step navigation
<Tabs value={currentSubStep} onValueChange={setCurrentSubStep}>
  <TabsList>
    <TabsTrigger value="mind-mapping">Mind Mapping</TabsTrigger>
    <TabsTrigger value="crazy-eights">Crazy 8s</TabsTrigger>
    <TabsTrigger value="brain-writing">Brain Writing</TabsTrigger>
  </TabsList>
  <TabsContent value="mind-mapping">
    {/* Chat + output for mind mapping */}
  </TabsContent>
  <TabsContent value="crazy-eights">
    {/* Chat + output for crazy 8s */}
  </TabsContent>
  <TabsContent value="brain-writing">
    {/* Chat + output for brain writing */}
  </TabsContent>
</Tabs>
```

**AI prompt needs sub-step context:**
```typescript
// src/lib/ai/prompts/step-prompts.ts
export function getStepSpecificInstructions(stepId: string, subStep?: string): string {
  if (stepId === 'ideation') {
    if (subStep === 'mind-mapping') return MIND_MAPPING_PROMPT;
    if (subStep === 'crazy-eights') return CRAZY_EIGHTS_PROMPT;
    if (subStep === 'brain-writing') return BRAIN_WRITING_PROMPT;
  }
  // ...
}
```

**Selection flow:**
- Ideas from all 3 sub-steps persist in component state
- Combined selection UI at end shows ideas from all sub-steps
- Final artifact merges all sub-step outputs into existing `ideationArtifactSchema`

**Pros:**
- Preserves 10-step mental model (sidebar shows Step 8: Ideation with progress indicator)
- URL stays `/step/8` (no breaking changes)
- Sub-steps are implementation detail, not exposed to users as "12 steps"
- Progress indicator within Step 8 (8a/8b/8c) shows sub-step context without expanding total count

**Cons:**
- More complex implementation — sub-step state must be managed in component
- No DB persistence for incomplete sub-steps (if user navigates away from Step 8 mid-sub-step, they lose progress)
- Conversation history doesn't naturally segment by sub-step (all messages tagged with stepId: 'ideation')
- Back-navigation within sub-steps is client-side only (no URL changes)

### Recommended Approach: B (Internal Sub-Steps)

**Rationale:**
- User decision explicitly states: "preserving 10-step mental model"
- Brand consistency: WorkshopPilot is a "10-step design thinking facilitator"
- Cognitive load: 10 steps is manageable, 12 starts feeling like "too many steps"
- Implementation complexity is acceptable trade-off for better UX

**Mitigation for cons:**
- Sub-step progress saved to localStorage as backup (not DB)
- Clear visual progress indicator (e.g., "Step 8: Ideation — 8b of 8c")
- Conversation history can include sub-step markers in message metadata (optional)

## Don't Hand-Roll

| Problem | Don't Build | Use Instead | Why |
|---------|-------------|-------------|-----|
| Confirmation dialogs | Custom modal with state management | shadcn/ui Dialog | Accessible, keyboard navigable, already in codebase |
| Tabbed UI for sub-steps | Custom tab switching logic | shadcn/ui Tabs | ARIA compliant, keyboard navigation, consistent styling |
| Cascade invalidation | New cascade logic | Existing `invalidateDownstreamSteps` | Already tested, handles edge cases (Step 10 has no downstream) |
| Server-side state mutations | Direct DB queries in components | Next.js Server Actions | Automatic revalidation, error handling, loading states |

**Key insight:** The codebase already has primitives for both features. Reset Step is a variant of `reviseStep` with additional deletions. Sub-steps can use existing component state patterns + shadcn/ui tabs.

## Common Pitfalls

### Pitfall 1: Accidentally Triggering Reset Without Confirmation

**What goes wrong:** User clicks "Reset Step" and immediately loses their work without a chance to cancel.

**Why it happens:** No confirmation dialog before destructive action.

**How to avoid:** Use shadcn/ui Dialog with explicit confirmation. Follow pattern from existing `exit-workshop-dialog.tsx`:

```typescript
<Dialog open={showResetDialog} onOpenChange={setShowResetDialog}>
  <DialogContent>
    <DialogHeader>
      <DialogTitle>Reset this step?</DialogTitle>
      <DialogDescription>
        This will clear your conversation, extracted output, and summary for this step.
        Downstream steps will be marked as needing regeneration. This cannot be undone.
      </DialogDescription>
    </DialogHeader>
    <DialogFooter>
      <Button variant="outline" onClick={() => setShowResetDialog(false)}>Cancel</Button>
      <Button variant="destructive" onClick={handleConfirmReset}>Reset Step</Button>
    </DialogFooter>
  </DialogContent>
</Dialog>
```

**Warning signs:** If reset action has no confirmation, users will report accidental data loss.

### Pitfall 2: Cascade Invalidation Deletes Too Much

**What goes wrong:** Reset Step clears data from downstream steps, not just the current step.

**Why it happens:** Misunderstanding of cascade invalidation vs. reset. Cascade invalidation marks downstream as `needs_regeneration` (preserves artifacts), but Reset Step should only clear data for the current step.

**How to avoid:**
- Reset Step clears: messages, artifact, summary for **current step only**
- Then calls `invalidateDownstreamSteps` which marks downstream as `needs_regeneration` WITHOUT deleting their data
- Downstream steps preserve artifacts/summaries as starting points (same as "Revise This Step")

**Correct flow:**
1. Delete chat_messages WHERE sessionId AND stepId = currentStep
2. Delete step_artifacts WHERE workshopStepId = currentStepRecord.id
3. Delete step_summaries WHERE workshopStepId = currentStepRecord.id
4. Call `invalidateDownstreamSteps(workshopId, currentStepId)` (does NOT delete downstream data)

### Pitfall 3: Sub-Step Navigation Loses Context Across Tabs

**What goes wrong:** User selects ideas in 8a Mind Mapping, switches to 8b Crazy 8s, returns to 8a and selections are lost.

**Why it happens:** Tab switching doesn't preserve state, or state is scoped to individual tab components instead of parent.

**How to avoid:** Lift selection state to parent Step 8 container:

```typescript
// Parent container manages all sub-step state
const [selectedIdeas, setSelectedIdeas] = useState<string[]>([]);
const [mindMappingIdeas, setMindMappingIdeas] = useState<Idea[]>([]);

// Pass state down to tab content components
<TabsContent value="mind-mapping">
  <MindMappingSubStep
    ideas={mindMappingIdeas}
    selectedIds={selectedIdeas}
    onSelect={setSelectedIdeas}
  />
</TabsContent>
```

**Warning signs:** Users report losing idea selections when switching tabs. Test by selecting ideas in 8a, switching to 8b, then back to 8a — selections should persist.

### Pitfall 4: Sub-Step Progress Not Visible to User

**What goes wrong:** User in Step 8 doesn't know they're on sub-step 8b of 8c, feels lost in a long ideation flow.

**Why it happens:** No visual progress indicator for sub-steps.

**How to avoid:** Add progress indicator in Step 8 header or sidebar:

```typescript
// In step container or sidebar when stepId === 'ideation'
<div className="text-sm text-muted-foreground">
  Step 8: Ideation — {currentSubStep === 'mind-mapping' ? '8a' : currentSubStep === 'crazy-eights' ? '8b' : '8c'} of 8c
</div>
```

Better: Use a horizontal stepper UI within Step 8 showing 8a → 8b → 8c with current position highlighted.

### Pitfall 5: Reordering Sub-Steps Breaks Existing Prompts

**What goes wrong:** Current Phase 13 prompt has Crazy 8s as Round 6 (after brain writing). User decision moves Crazy 8s to Round 4 (before brain writing). If prompt isn't updated, flow is confusing.

**Why it happens:** Prompt describes rounds in old order, but UI implements new order.

**How to avoid:**
- Update `getStepSpecificInstructions('ideation')` to match new order:
  - 8a: Mind Mapping (cluster generation + user input)
  - 8b: Crazy 8s (rapid-fire 8 ideas)
  - 8c: Brain Writing (build on favorites from 8a + 8b)
- Update validation criteria to check for new order
- Update `ideation-cluster-view.tsx` to render in new order

## Code Examples

### Example 1: Reset Step Server Action

```typescript
// src/actions/workshop-actions.ts
'use server';

import { db } from '@/db/client';
import { workshopSteps, chatMessages, stepArtifacts, stepSummaries } from '@/db/schema';
import { eq, and } from 'drizzle-orm';
import { invalidateDownstreamSteps } from '@/lib/navigation/cascade-invalidation';
import { revalidatePath } from 'next/cache';

export async function resetStep(
  workshopId: string,
  stepId: string,
  sessionId: string
): Promise<void> {
  try {
    // 1. Get the workshopStep record
    const [workshopStepRecord] = await db
      .select({ id: workshopSteps.id })
      .from(workshopSteps)
      .where(and(
        eq(workshopSteps.workshopId, workshopId),
        eq(workshopSteps.stepId, stepId)
      ))
      .limit(1);

    if (!workshopStepRecord) {
      throw new Error(`Workshop step not found: ${stepId}`);
    }

    // 2. Delete conversation history for this step
    await db.delete(chatMessages)
      .where(and(
        eq(chatMessages.sessionId, sessionId),
        eq(chatMessages.stepId, stepId)
      ));

    // 3. Delete artifact for this step (cascade delete handles FK)
    await db.delete(stepArtifacts)
      .where(eq(stepArtifacts.workshopStepId, workshopStepRecord.id));

    // 4. Delete summary for this step (cascade delete handles FK)
    await db.delete(stepSummaries)
      .where(eq(stepSummaries.workshopStepId, workshopStepRecord.id));

    // 5. Cascade invalidate downstream steps
    // This resets current step to in_progress + marks downstream as needs_regeneration
    await invalidateDownstreamSteps(workshopId, stepId);

    // 6. Revalidate workshop layout to refresh sidebar
    revalidatePath(`/workshop/${sessionId}`);
  } catch (error) {
    console.error('Failed to reset step:', error);
    throw error;
  }
}
```

### Example 2: Step 8 Sub-Step Container with Tabs

```typescript
// src/components/workshop/step-container.tsx (Step 8 specific logic)
'use client';

import { useState } from 'react';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';

type IdeationSubStep = 'mind-mapping' | 'crazy-eights' | 'brain-writing';

export function IdeationStepContainer({ stepId, workshopId, sessionId }) {
  const [currentSubStep, setCurrentSubStep] = useState<IdeationSubStep>('mind-mapping');

  // Shared state across all sub-steps
  const [mindMappingIdeas, setMindMappingIdeas] = useState<Idea[]>([]);
  const [crazyEightsIdeas, setCrazyEightsIdeas] = useState<Idea[]>([]);
  const [brainWrittenIdeas, setBrainWrittenIdeas] = useState<BrainWrittenIdea[]>([]);
  const [selectedIdeas, setSelectedIdeas] = useState<string[]>([]);

  // Determine which sub-steps are complete
  const mindMappingComplete = mindMappingIdeas.length > 0;
  const crazyEightsComplete = crazyEightsIdeas.length >= 8;
  const brainWritingComplete = brainWrittenIdeas.length > 0;

  return (
    <div className="flex h-full flex-col">
      {/* Progress indicator */}
      <div className="px-6 pt-4">
        <div className="flex items-center gap-2 text-sm text-muted-foreground">
          <span>Step 8: Ideation</span>
          <span>—</span>
          <span>
            {currentSubStep === 'mind-mapping' && '8a: Mind Mapping'}
            {currentSubStep === 'crazy-eights' && '8b: Crazy 8s'}
            {currentSubStep === 'brain-writing' && '8c: Brain Writing'}
          </span>
        </div>
      </div>

      <Tabs value={currentSubStep} onValueChange={setCurrentSubStep} className="flex-1">
        <TabsList className="mx-6 mt-4">
          <TabsTrigger value="mind-mapping">
            Mind Mapping {mindMappingComplete && '✓'}
          </TabsTrigger>
          <TabsTrigger value="crazy-eights" disabled={!mindMappingComplete}>
            Crazy 8s {crazyEightsComplete && '✓'}
          </TabsTrigger>
          <TabsTrigger value="brain-writing" disabled={!crazyEightsComplete}>
            Brain Writing {brainWritingComplete && '✓'}
          </TabsTrigger>
        </TabsList>

        <TabsContent value="mind-mapping" className="flex-1">
          {/* Chat pane + output panel for 8a */}
        </TabsContent>

        <TabsContent value="crazy-eights" className="flex-1">
          {/* Chat pane + output panel for 8b */}
        </TabsContent>

        <TabsContent value="brain-writing" className="flex-1">
          {/* Chat pane + output panel for 8c */}
          {/* Combined selection UI at end */}
        </TabsContent>
      </Tabs>
    </div>
  );
}
```

## State of the Art

| Old Approach | Current Approach | When Changed | Impact |
|--------------|------------------|--------------|--------|
| No step reset | Reset Step with cascade | Phase 13.1 | Users can recover from wrong paths without restarting workshop |
| 6-round linear ideation | 3 sub-steps with reordered flow | Phase 13.1 | Crazy 8s before Brain Writing follows better diverge-then-converge pattern |
| No sub-step UI | Tabbed sub-step navigation | Phase 13.1 | Clearer structure, prevents cognitive overload in long Step 8 |
| Generic idea selection | Interactive chat-pane selection | Phase 13.1 | More engaging UX, reduces friction in selection flow |

**Deprecated/outdated:**
- Mega-prompt for all 6 ideation rounds: Split into 3 focused sub-step prompts
- Text-only idea selection: Add interactive selection UI in chat pane

## Open Questions

1. **Sub-step conversation history**
   - What we know: All messages tagged with stepId: 'ideation', no sub-step differentiation
   - What's unclear: Should messages include sub-step metadata for future segmentation?
   - Recommendation: Add optional `subStep` field to chat_messages for future filtering (not required for MVP)

2. **Sub-step artifact persistence**
   - What we know: Final artifact merges all sub-step outputs
   - What's unclear: Should intermediate sub-step artifacts be saved to DB?
   - Recommendation: No — keep sub-step state client-side, only final merged artifact persists to DB

3. **Interactive selection UI in chat pane**
   - What we know: User decision says "interactive selection, not just text"
   - What's unclear: Should this be a custom message type or a special UI component in chat?
   - Recommendation: Custom message type with embedded selection UI (similar to how AI SDK tool calls work)

4. **Reset Step vs. Revise This Step naming**
   - What we know: Both reset step to in_progress, both cascade downstream
   - What's unclear: Should Reset be a sub-action of Revise, or separate?
   - Recommendation: Separate actions — "Reset Step" for current step (clears data), "Revise This Step" for completed steps (preserves data)

## Sources

### Primary (HIGH confidence)

- Codebase investigation: `/Users/michaelchristie/devProjects/workshoppilot.ai/src/lib/navigation/cascade-invalidation.ts` (existing implementation)
- Codebase investigation: `/Users/michaelchristie/devProjects/workshoppilot.ai/src/actions/workshop-actions.ts` (server action patterns)
- Codebase investigation: `/Users/michaelchristie/devProjects/workshoppilot.ai/src/db/schema/` (database schema with cascade deletes)
- Codebase investigation: `/Users/michaelchristie/devProjects/workshoppilot.ai/src/lib/schemas/step-schemas.ts` (Step 8 artifact structure)
- Codebase investigation: `/Users/michaelchristie/devProjects/workshoppilot.ai/.planning/phases/13-ideation-validation-steps-8-10/13-01-PLAN.md` (Step 8 implementation)
- Codebase investigation: `/Users/michaelchristie/devProjects/workshoppilot.ai/.planning/phases/10-navigation-persistence/10-02-PLAN.md` (cascade invalidation design)

### Secondary (MEDIUM confidence)

- [shadcn/ui Tabs Component](https://ui.shadcn.com/docs/components/radix/tabs) - Accessible tabs with keyboard navigation
- [shadcn/ui Dialog Component](https://ui.shadcn.com/docs/components/radix/dialog) - Confirmation dialog patterns
- User decision document: `/Users/michaelchristie/devProjects/workshoppilot.ai/.planning/next-features.md` (sub-step requirements)

## Metadata

**Confidence breakdown:**
- Reset Step server action: HIGH - Direct extension of existing `reviseStep` pattern
- Cascade invalidation reuse: HIGH - Already implemented and tested in Phase 10
- Sub-step architecture: MEDIUM - Internal state approach is more complex than DB-backed steps
- shadcn/ui Tabs integration: HIGH - Standard pattern, well-documented, accessible
- Interactive selection UI: MEDIUM - Custom implementation needed, no existing pattern in codebase

**Research date:** 2026-02-10
**Valid until:** 60 days (architecture is stable, patterns are established)
