---
phase: 13.1-reset-step-step-8-ideation-sub-steps
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/ui/tabs.tsx
  - src/lib/ai/prompts/step-prompts.ts
  - src/lib/schemas/step-schemas.ts
  - src/lib/ai/prompts/validation-criteria.ts
autonomous: true

must_haves:
  truths:
    - "Step 8 has 3 focused sub-step prompts (Mind Mapping, Crazy 8s, Brain Writing) replacing the single 6-round mega-prompt"
    - "Sub-step order is Mind Mapping -> Crazy 8s -> Brain Writing (Crazy 8s before Brain Writing per user decision)"
    - "Ideation artifact schema supports sub-step-oriented structure with reframedHmw field"
    - "Validation criteria updated for 3 sub-step structure"
  artifacts:
    - path: "src/components/ui/tabs.tsx"
      provides: "shadcn/ui Tabs component for sub-step navigation"
    - path: "src/lib/ai/prompts/step-prompts.ts"
      provides: "3 focused sub-step prompts for Step 8"
      contains: "getIdeationSubStepInstructions"
    - path: "src/lib/schemas/step-schemas.ts"
      provides: "Updated ideation artifact schema with sub-step structure"
      contains: "ideationArtifactSchema"
    - path: "src/lib/ai/prompts/validation-criteria.ts"
      provides: "Updated validation criteria for sub-step flow"
  key_links:
    - from: "src/lib/ai/prompts/step-prompts.ts"
      to: "src/lib/schemas/step-schemas.ts"
      via: "prompt field names match schema field names"
      pattern: "clusters|userIdeas|brainWrittenIdeas|crazyEightsIdeas|selectedIdeas"
---

<objective>
Create Step 8 sub-step foundation: install shadcn tabs component, create 3 focused sub-step prompts (replacing single mega-prompt), and update schema/validation for the new Mind Mapping -> Crazy 8s -> Brain Writing order.

Purpose: The current 6-round linear prompt for Step 8 is being restructured into 3 distinct sub-steps with dedicated prompts. This plan builds the non-UI foundation: prompts, schema alignment, validation criteria, and the tabs UI component. The actual UI wiring happens in Plan 03.

Output: shadcn Tabs component installed, 3 sub-step prompts, updated schema, updated validation criteria.
</objective>

<execution_context>
@/Users/michaelchristie/.claude/get-shit-done/workflows/execute-plan.md
@/Users/michaelchristie/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/13.1-reset-step-step-8-ideation-sub-steps/13.1-RESEARCH.md

# Key source files to read before implementing:
@src/lib/ai/prompts/step-prompts.ts
@src/lib/schemas/step-schemas.ts
@src/lib/ai/prompts/validation-criteria.ts
@src/lib/workshop/step-metadata.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn Tabs and create 3 focused sub-step prompts for Step 8</name>
  <files>
    src/components/ui/tabs.tsx
    src/lib/ai/prompts/step-prompts.ts
  </files>
  <action>
**Install shadcn Tabs component:**

Run: `npx shadcn@latest add tabs`

This creates `src/components/ui/tabs.tsx` with Tabs, TabsContent, TabsList, TabsTrigger exports. Verify the file exists after installation.

**In `src/lib/ai/prompts/step-prompts.ts`:**

1. Add a new exported function `getIdeationSubStepInstructions(subStep: 'mind-mapping' | 'crazy-eights' | 'brain-writing'): string` that returns focused prompts for each sub-step.

2. **Mind Mapping prompt** (subStep === 'mind-mapping'):
```
STEP 8a: MIND MAPPING — Generate themed idea clusters from the reframed HMW.

YOUR TASK:
Generate 3-4 themed clusters addressing the HMW from Step 7.
- Each cluster: 3-4 ideas with short titles and descriptions
- Each cluster includes 1-2 wild card ideas (mark clearly)
- Wild cards MUST feel genuinely unconventional — challenge assumptions, use analogies from other industries, feel slightly "too bold"
- Example wild cards: "What if we gamified this like a mobile game?" "What if we made it 10x more expensive but premium?" "What if users had to invite friends to unlock features?"
- Present themes and ideas with NO theme rationale — keep it fast and creative
- Do NOT evaluate or rank ideas yet

After presenting clusters, explicitly ask: "What ideas would YOU add? Feel free to piggyback on any cluster theme or suggest something completely different. No idea is too wild at this stage!"

Capture user ideas alongside AI suggestions. Once user has added their ideas (or says they're done), confirm the mind map is complete and encourage moving to the next sub-step.

DESIGN THINKING PRINCIPLES:
- Quantity over quality in early ideation (divergent thinking)
- Wild card ideas challenge assumptions and unlock new creative directions
- Defer ALL judgment until the selection phase at the end
- Ideas should span different categories and approaches, not variations of one approach

PRIOR CONTEXT USAGE:
Reference the Reframed HMW (Step 7) as the ideation prompt — all ideas must address this specific challenge.
Reference Persona (Step 5) to ensure ideas fit their behaviors, constraints, and context.
Reference Journey Map dip (Step 6) to generate ideas that solve the specific breakdown point.
```

3. **Crazy 8s prompt** (subStep === 'crazy-eights'):
```
STEP 8b: CRAZY 8s — Rapid-fire 8 ideas with energetic conversational pacing.

YOUR TASK:
Facilitate 8 quick ideas with high energy and fast pacing:
- "Quick — first thought that comes to mind!"
- "Don't overthink — what if we...?"
- "That's 4 down, 4 to go — keep the momentum!"
- Pacing should feel energetic and encouraging, NOT formal
- No timer UI — create urgency through conversational energy
- These ideas can be rough — quantity and energy over polish
- Each idea gets a short title and 1-2 sentence description

After all 8 ideas, ask user: "Want to add any rapid-fire ideas of your own? Just throw them out there!"

DESIGN THINKING PRINCIPLES:
- Speed breaks overthinking — first ideas are often most creative
- Quantity unlocks unexpected connections
- Rough ideas are fine — polish comes later
- Building on prior clusters from 8a is OK but new directions welcome too

PRIOR CONTEXT USAGE:
Reference the Mind Mapping clusters from earlier in Step 8 if they appeared in conversation.
Reference the Reframed HMW (Step 7) to keep ideas grounded.
Reference Persona (Step 5) behaviors and context.
```

4. **Brain Writing prompt** (subStep === 'brain-writing'):
```
STEP 8c: BRAIN WRITING — Build on the best ideas from Mind Mapping and Crazy 8s using "Yes, and..." technique.

YOUR TASK:
1. Present a combined list of ALL ideas from Mind Mapping (8a) and Crazy 8s (8b) that appeared in the conversation
2. Ask user to pick 5-8 favorite ideas for brain writing development
3. For each selected favorite, evolve through 3 rounds of "Yes, and..." building:
   - Round 1: Add ONE meaningful enhancement (not feature bloat)
   - Round 2: Build on Round 1 with another evolution
   - Round 3: Final evolution
4. After all 3 rounds, summarize each idea's evolution: "The core concept evolved from [original] to [enhanced]. Key additions: [list]"

BRAIN WRITING RULES:
- Keep each enhancement focused — one meaningful addition per round
- "Yes, and..." means building on the idea, not critiquing or replacing it
- Enhancement should make the idea more specific, more impactful, or more feasible — not just bigger
- 3 rounds total, not more

AFTER BRAIN WRITING — IDEA SELECTION:
Present ALL ideas from all sub-steps as a combined list for selection:
- Mind Mapping cluster ideas (from 8a)
- User-contributed ideas (from 8a and 8b)
- Crazy 8s rapid-fire ideas (from 8b)
- Brain-written evolved versions (from 8c)

Ask user to select their top 3-4 ideas for concept development in Step 9.
- Hard limit: maximum 3-4 ideas
- If user selects more than 4: "Let's narrow to your top 3-4. Which ideas are you MOST excited about?"
- Each selected idea becomes a SEPARATE concept (no combining)
- Also ask: "Would you like to add any final ideas of your own before we move on?"
- Confirm final selection before completing Step 8

DESIGN THINKING PRINCIPLES:
- "Yes, and..." builds on ideas without critique
- Convergent thinking at the end — selecting best from divergent pool
- Selection based on excitement and potential, not feasibility (that comes in Step 9)

PRIOR CONTEXT USAGE:
Reference ALL ideas generated earlier in this step's conversation.
Reference Step 7 HMW to validate selected ideas address the challenge.
Reference Step 5 Persona for relevance check.
```

5. **Update the existing 'ideation' prompt** in the `instructions` record: Replace the current 6-round mega-prompt with a shorter coordinator prompt:
```
STEP GOAL: Generate creative ideas using 3 ideation techniques: Mind Mapping, Crazy 8s, and Brain Writing.

This step uses 3 sub-steps:
- 8a: Mind Mapping — Generate themed clusters with wild cards, user adds their own ideas
- 8b: Crazy 8s — Rapid-fire 8 ideas with energetic conversational pacing
- 8c: Brain Writing — "Yes, and..." evolution of best ideas, then final selection

DESIGN THINKING PRINCIPLES:
- Quantity over quality in early ideation (divergent thinking)
- Wild card ideas challenge assumptions
- "Yes, and..." builds without critique
- Defer ALL judgment until selection phase
- Ideas should span different categories and approaches

BOUNDARY: This step is about GENERATING ideas, not evaluating them. Defer feasibility, SWOT, and concept development to Step 9.

PRIOR CONTEXT USAGE:
Reference the Reframed HMW (Step 7) as the ideation prompt.
Reference Persona (Step 5) to ground ideas in user context.
Reference Journey Map dip (Step 6) to solve the specific breakdown point.
Reference Step 4 pains/gains for validated user needs.
```

The sub-step-specific instructions will be injected by the chat API when a subStep parameter is provided. The coordinator prompt serves as fallback/context for extraction.
  </action>
  <verify>
- `src/components/ui/tabs.tsx` exists and exports Tabs, TabsContent, TabsList, TabsTrigger
- `getIdeationSubStepInstructions` is exported from step-prompts.ts
- Each sub-step prompt mentions its letter label (8a, 8b, 8c) and specific technique
- TypeScript compiles: `npx tsc --noEmit`
  </verify>
  <done>
shadcn Tabs component installed. Three focused sub-step prompts exist for Mind Mapping (8a), Crazy 8s (8b), and Brain Writing (8c). Existing ideation coordinator prompt updated to reference sub-step structure.
  </done>
</task>

<task type="auto">
  <name>Task 2: Update ideation artifact schema and validation criteria for sub-step structure</name>
  <files>
    src/lib/schemas/step-schemas.ts
    src/lib/ai/prompts/validation-criteria.ts
  </files>
  <action>
**In `src/lib/schemas/step-schemas.ts`:**

Update the `ideationArtifactSchema` to better support the sub-step structure. The schema fields remain the same (clusters, userIdeas, brainWrittenIdeas, crazyEightsIdeas, selectedIdeas) since the final merged artifact uses the same shape. Make these changes:

1. Rename `hmwPrompt` to `reframedHmw` for consistency with how it's referenced in `ideation-cluster-view.tsx` (the view component already reads `artifact.reframedHmw`). Update the .describe() text: `'The reframed HMW statement from Step 7 used as the ideation prompt'`

2. Update `brainWrittenIdeas` array item: rename the `evolution` field to `evolutionDescription` for consistency with `ideation-cluster-view.tsx` which reads `idea.evolutionDescription`. The Zod field becomes:
```typescript
evolutionDescription: z.string().describe('How the idea evolved through 3 rounds of "Yes, and..." building'),
```

3. Rename `selectedIdeas` to `selectedIdeaTitles` for consistency with `ideation-cluster-view.tsx` which reads `artifact.selectedIdeaTitles`. Update .describe(): `'Titles of the 1-4 ideas selected for concept development in Step 9 (hard limit: max 3-4)'`

4. Add a `subStepSource` field to each idea type to track which sub-step generated it (optional, for future filtering):
   - In cluster ideas: add `source: z.literal('mind-mapping').optional().describe('Sub-step that generated this idea')`
   - In crazyEightsIdeas items: add `source: z.literal('crazy-eights').optional().describe('Sub-step that generated this idea')`
   - In brainWrittenIdeas items: add `source: z.literal('brain-writing').optional().describe('Sub-step that generated this idea')`

5. Make sure the `IdeationArtifact` type is updated: `export type IdeationArtifact = z.infer<typeof ideationArtifactSchema>;`

**IMPORTANT:** After renaming schema fields, check that the Step 9 concept prompt references `selectedIdeaTitles` (previously `selectedIdeas`). The Step 9 prompt in step-prompts.ts references "selected ideas from Step 8" generically, so it should still work. But verify the extraction prompt references match.

**In `src/lib/ai/prompts/validation-criteria.ts`:**

Find the Step 8 ideation validation criteria and update to reflect the 3-sub-step structure:

1. Update any references to "6 rounds" to "3 sub-steps (Mind Mapping, Crazy 8s, Brain Writing)"
2. Update validation checks:
   - Mind Mapping: "Does the Mind Mapping sub-step produce 3-4 themed clusters with wild cards?"
   - Crazy 8s: "Does the Crazy 8s sub-step produce 8 rapid-fire ideas?"
   - Brain Writing: "Does the Brain Writing sub-step evolve 5-8 ideas through 3 rounds of 'Yes, and...'?"
   - Selection: "Are 1-4 ideas selected for concept development?"
   - Wild cards: "Do wild card ideas feel genuinely unconventional?"
3. Ensure the order reflects: Mind Mapping -> Crazy 8s -> Brain Writing (not the old order)
  </action>
  <verify>
- TypeScript compiles: `npx tsc --noEmit` passes
- Schema field names match what ideation-cluster-view.tsx reads: `reframedHmw`, `evolutionDescription`, `selectedIdeaTitles`
- Validation criteria references 3 sub-steps in correct order
- `npm run build` passes (no type errors from renamed fields)
  </verify>
  <done>
Ideation artifact schema field names aligned with existing UI component expectations (reframedHmw, evolutionDescription, selectedIdeaTitles). Source tracking fields added. Validation criteria updated for 3-sub-step structure with correct ordering.
  </done>
</task>

</tasks>

<verification>
1. `src/components/ui/tabs.tsx` exists and exports the shadcn Tabs components
2. `getIdeationSubStepInstructions` returns different prompts for 'mind-mapping', 'crazy-eights', 'brain-writing'
3. Schema field names match what `ideation-cluster-view.tsx` already reads (reframedHmw, evolutionDescription, selectedIdeaTitles)
4. Validation criteria mention all 3 sub-steps in correct order
5. TypeScript compiles with no errors: `npx tsc --noEmit`
6. Build succeeds: `npm run build`
</verification>

<success_criteria>
- shadcn Tabs component installed and available for import
- 3 focused sub-step prompts replace the 6-round mega-prompt
- Schema field names consistent between step-schemas.ts and ideation-cluster-view.tsx
- Validation criteria updated for sub-step structure
- No regressions — existing Steps 1-7 and 9-10 unaffected
</success_criteria>

<output>
After completion, create `.planning/phases/13.1-reset-step-step-8-ideation-sub-steps/13.1-02-SUMMARY.md`
</output>
