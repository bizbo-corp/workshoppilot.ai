---
phase: 32-workshop-management
plan: 02
type: execute
wave: 2
depends_on: ["32-01"]
files_modified:
  - src/components/dashboard/workshop-card.tsx
  - src/components/dashboard/workshop-grid.tsx
  - src/app/dashboard/page.tsx
autonomous: true

must_haves:
  truths:
    - "User can select one or more workshops on dashboard via checkbox"
    - "User can delete selected workshops via delete button with confirmation dialog"
    - "Dashboard updates immediately after deletion without page refresh"
    - "Confirmation dialog warns user about permanent action with workshop count"
    - "Select all checkbox toggles all workshops"
  artifacts:
    - path: "src/components/dashboard/workshop-grid.tsx"
      provides: "Client-side workshop grid with selection state, delete button, and confirmation dialog"
      min_lines: 80
    - path: "src/components/dashboard/workshop-card.tsx"
      provides: "Workshop card with optional checkbox for selection mode"
      contains: "checkbox"
    - path: "src/components/ui/checkbox.tsx"
      provides: "shadcn checkbox component"
    - path: "src/components/ui/alert-dialog.tsx"
      provides: "shadcn alert-dialog component for delete confirmation"
  key_links:
    - from: "src/components/dashboard/workshop-grid.tsx"
      to: "src/actions/workshop-actions.ts"
      via: "Calls deleteWorkshops server action"
      pattern: "deleteWorkshops"
    - from: "src/components/dashboard/workshop-grid.tsx"
      to: "src/components/dashboard/workshop-card.tsx"
      via: "Renders WorkshopCard with selection props"
      pattern: "WorkshopCard"
    - from: "src/app/dashboard/page.tsx"
      to: "src/components/dashboard/workshop-grid.tsx"
      via: "Renders WorkshopGrid with workshop data"
      pattern: "WorkshopGrid"
---

<objective>
Build the dashboard selection and deletion UI: install shadcn checkbox and alert-dialog, create a client-side WorkshopGrid component that manages selection state, add checkboxes to workshop cards, and wire the delete flow with confirmation dialog.

Purpose: Enable users to select and delete workshops from their dashboard with a safe, confirmed interaction.
Output: Fully functional select-and-delete UX on the dashboard.
</objective>

<execution_context>
@/Users/michaelchristie/.claude/get-shit-done/workflows/execute-plan.md
@/Users/michaelchristie/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/32-workshop-management/32-01-SUMMARY.md

@src/app/dashboard/page.tsx
@src/components/dashboard/workshop-card.tsx
@src/actions/workshop-actions.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install shadcn components and create WorkshopGrid with selection + delete</name>
  <files>src/components/ui/checkbox.tsx, src/components/ui/alert-dialog.tsx, src/components/dashboard/workshop-grid.tsx, src/components/dashboard/workshop-card.tsx</files>
  <action>
**Step 1: Install shadcn components**

```bash
npx shadcn@latest add checkbox --yes
npx shadcn@latest add alert-dialog --yes
```

**Step 2: Create `src/components/dashboard/workshop-grid.tsx`**

This is a new client component that wraps the workshop card grid and manages selection state + delete flow. It receives the workshop data as props from the server component dashboard page.

```typescript
'use client';

import { useState, useTransition } from 'react';
import { Trash2 } from 'lucide-react';
import { Button } from '@/components/ui/button';
import { Checkbox } from '@/components/ui/checkbox';
import {
  AlertDialog,
  AlertDialogAction,
  AlertDialogCancel,
  AlertDialogContent,
  AlertDialogDescription,
  AlertDialogFooter,
  AlertDialogHeader,
  AlertDialogTitle,
  AlertDialogTrigger,
} from '@/components/ui/alert-dialog';
import { WorkshopCard } from '@/components/dashboard/workshop-card';
import { deleteWorkshops } from '@/actions/workshop-actions';

interface WorkshopData {
  id: string;
  sessionId: string;
  title: string;
  currentStep: number;
  currentStepName: string;
  updatedAt: Date;
}

interface WorkshopGridProps {
  workshops: WorkshopData[];
  onRename: (workshopId: string, newName: string) => Promise<void>;
}

export function WorkshopGrid({ workshops, onRename }: WorkshopGridProps) {
  const [selectedIds, setSelectedIds] = useState<Set<string>>(new Set());
  const [isPending, startTransition] = useTransition();
  const [dialogOpen, setDialogOpen] = useState(false);

  const hasSelection = selectedIds.size > 0;
  const allSelected = selectedIds.size === workshops.length && workshops.length > 0;

  const toggleSelect = (id: string) => {
    setSelectedIds((prev) => {
      const next = new Set(prev);
      if (next.has(id)) {
        next.delete(id);
      } else {
        next.add(id);
      }
      return next;
    });
  };

  const toggleSelectAll = () => {
    if (allSelected) {
      setSelectedIds(new Set());
    } else {
      setSelectedIds(new Set(workshops.map((w) => w.id)));
    }
  };

  const handleDelete = () => {
    const ids = Array.from(selectedIds);
    startTransition(async () => {
      try {
        await deleteWorkshops(ids);
        setSelectedIds(new Set());
        setDialogOpen(false);
      } catch (error) {
        console.error('Failed to delete workshops:', error);
      }
    });
  };

  return (
    <div className="mb-6">
      {/* Header with select all and delete controls */}
      <div className="mb-4 flex items-center justify-between">
        <div className="flex items-center gap-3">
          <h2 className="text-xl font-semibold text-foreground">All Workshops</h2>
          <div className="flex items-center gap-2">
            <Checkbox
              id="select-all"
              checked={allSelected}
              onCheckedChange={toggleSelectAll}
              aria-label="Select all workshops"
            />
            <label htmlFor="select-all" className="text-sm text-muted-foreground cursor-pointer">
              Select all
            </label>
          </div>
        </div>

        {hasSelection && (
          <AlertDialog open={dialogOpen} onOpenChange={setDialogOpen}>
            <AlertDialogTrigger asChild>
              <Button variant="destructive" size="sm">
                <Trash2 className="mr-2 h-4 w-4" />
                Delete {selectedIds.size} {selectedIds.size === 1 ? 'workshop' : 'workshops'}
              </Button>
            </AlertDialogTrigger>
            <AlertDialogContent>
              <AlertDialogHeader>
                <AlertDialogTitle>Delete {selectedIds.size === 1 ? 'workshop' : 'workshops'}?</AlertDialogTitle>
                <AlertDialogDescription>
                  {selectedIds.size === 1
                    ? 'This workshop will be removed from your dashboard. This action cannot be undone from the UI.'
                    : `These ${selectedIds.size} workshops will be removed from your dashboard. This action cannot be undone from the UI.`}
                </AlertDialogDescription>
              </AlertDialogHeader>
              <AlertDialogFooter>
                <AlertDialogCancel disabled={isPending}>Cancel</AlertDialogCancel>
                <AlertDialogAction
                  onClick={handleDelete}
                  disabled={isPending}
                  className="bg-destructive text-destructive-foreground hover:bg-destructive/90"
                >
                  {isPending ? 'Deleting...' : 'Delete'}
                </AlertDialogAction>
              </AlertDialogFooter>
            </AlertDialogContent>
          </AlertDialog>
        )}
      </div>

      {/* Workshop card grid */}
      <div className="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {workshops.map((workshop) => (
          <WorkshopCard
            key={workshop.id}
            workshopId={workshop.id}
            sessionId={workshop.sessionId}
            title={workshop.title}
            currentStep={workshop.currentStep}
            currentStepName={workshop.currentStepName}
            updatedAt={workshop.updatedAt}
            onRename={onRename}
            selected={selectedIds.has(workshop.id)}
            onSelect={() => toggleSelect(workshop.id)}
          />
        ))}
      </div>
    </div>
  );
}
```

**Step 3: Update `src/components/dashboard/workshop-card.tsx`**

Add optional `selected` and `onSelect` props for selection mode:

1. Add `Checkbox` import from `@/components/ui/checkbox`
2. Extend the `WorkshopCardProps` interface with:
   - `selected?: boolean`
   - `onSelect?: () => void`
3. Add these props to the component destructuring (with defaults: `selected = false`, `onSelect`)
4. Add a checkbox overlay in the top-right corner of the card, visible when `onSelect` is provided:

Inside the `<Card>` element, before the `<Link>`, add:
```tsx
{onSelect && (
  <div
    className="absolute right-3 top-3 z-10"
    onClick={(e) => {
      e.preventDefault();
      e.stopPropagation();
      onSelect();
    }}
  >
    <Checkbox
      checked={selected}
      aria-label={`Select ${title}`}
      className="h-5 w-5"
    />
  </div>
)}
```

5. Add visual feedback when selected: conditionally add a ring/border highlight to the Card:
```tsx
<Card className={cn(
  "group relative overflow-hidden border border-border transition-all hover:shadow-md dark:hover:border-gray-700",
  selected && "ring-2 ring-primary border-primary"
)}>
```

6. Import `cn` from `@/lib/utils` (if not already imported).
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm TypeScript compiles cleanly.

Verify the shadcn components were installed:
```bash
ls src/components/ui/checkbox.tsx src/components/ui/alert-dialog.tsx
```
  </verify>
  <done>shadcn checkbox and alert-dialog installed. WorkshopGrid manages selection state, shows select-all checkbox, delete button with count, and confirmation dialog. WorkshopCard has optional checkbox overlay with selection ring highlight.</done>
</task>

<task type="auto">
  <name>Task 2: Wire WorkshopGrid into dashboard page</name>
  <files>src/app/dashboard/page.tsx</files>
  <action>
Update `src/app/dashboard/page.tsx` to use the new `WorkshopGrid` component instead of directly rendering the card grid.

1. Add import for WorkshopGrid:
```typescript
import { WorkshopGrid } from '@/components/dashboard/workshop-grid';
```

2. Replace the "All Workshops" section (the `<div className="mb-6">` block containing the h2 and grid) with:
```tsx
<WorkshopGrid
  workshops={workshopsWithProgress.map((w) => ({
    id: w.id,
    sessionId: w.sessionId,
    title: w.title,
    currentStep: w.currentStep,
    currentStepName: w.currentStepName,
    updatedAt: w.updatedAt,
  }))}
  onRename={renameWorkshop}
/>
```

This replaces the existing block that was:
```tsx
<div className="mb-6">
  <h2 className="mb-4 text-xl font-semibold text-foreground">All Workshops</h2>
  <div className="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
    {workshopsWithProgress.map((workshop) => (
      <WorkshopCard
        key={workshop.id}
        workshopId={workshop.id}
        sessionId={workshop.sessionId}
        title={workshop.title}
        currentStep={workshop.currentStep}
        currentStepName={workshop.currentStepName}
        updatedAt={workshop.updatedAt}
        onRename={renameWorkshop}
      />
    ))}
  </div>
</div>
```

3. Remove the now-unused direct `WorkshopCard` import if nothing else in the file uses it (the grid component imports it instead). Keep the `deleteWorkshops` import from Plan 01 (it's used by WorkshopGrid via the action, but WorkshopGrid imports it directly so it can be removed from this file too if unused).

Clean up: remove `WorkshopCard` from imports since WorkshopGrid handles rendering cards. Also remove `deleteWorkshops` from the import if it's no longer referenced directly in this file.
  </action>
  <verify>
Run `npx tsc --noEmit` to confirm TypeScript compiles cleanly.

Run `npm run dev` and visit `/dashboard`:
1. Workshops display in grid with checkboxes in top-right corner
2. Clicking a checkbox selects the workshop (ring highlight appears)
3. "Select all" checkbox toggles all workshops
4. When workshops selected, red "Delete N workshops" button appears
5. Clicking delete button shows confirmation dialog
6. Confirming deletion removes workshops from the grid (revalidatePath refresh)
7. Workshop cards are still clickable to navigate to workshop
8. Workshop titles still editable via click-to-rename
  </verify>
  <done>Dashboard page uses WorkshopGrid component. Selection checkboxes visible on all workshop cards. Delete button appears when workshops selected. Confirmation dialog protects against accidental deletion. Dashboard refreshes after deletion.</done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes with no errors
2. Dashboard shows workshop cards with selection checkboxes
3. Selecting workshops shows delete button with count
4. Delete confirmation dialog appears with appropriate warning text
5. Confirming deletion removes workshops from dashboard
6. "Select all" checkbox works to select/deselect all workshops
7. Workshop card navigation (click to continue) still works
8. Workshop rename (click title to edit) still works
9. Dashboard does not show previously deleted workshops on page reload
</verification>

<success_criteria>
- User can select one or more workshops via checkbox on each card
- "Select all" toggles entire selection
- Delete button appears only when workshops are selected, showing count
- Confirmation dialog warns about permanent action
- Deletion calls deleteWorkshops server action and dashboard updates immediately
- Card click-through and rename still function correctly
</success_criteria>

<output>
After completion, create `.planning/phases/32-workshop-management/32-02-SUMMARY.md`
</output>
