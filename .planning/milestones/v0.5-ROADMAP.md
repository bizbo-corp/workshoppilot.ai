# Milestone v0.5: Application Shell

**Status:** SHIPPED 2026-02-08
**Phases:** 1-6
**Total Plans:** 19

## Overview

MVP 0.5 establishes the application shell — a working skeleton of the 10-step design thinking workshop platform. Starting from the existing Next.js scaffold, we layered authentication, database persistence, application structure with all 10 step containers, navigation flow, basic AI chat, and deployed to production. This shell validates the technical stack (Clerk + Neon + Gemini + Drizzle) and provides a foundation for MVP 1.0's AI facilitation features.

## Phases

### Phase 1: Foundation & Database

**Goal**: Database schema defined, Neon Postgres connected, edge-compatible persistence layer working
**Depends on**: Nothing (first phase)
**Requirements**: DATA-01, DATA-02, DATA-03
**Plans**: 3 plans

Plans:

- [x] 01-01-PLAN.md — Install deps, configure Drizzle Kit, create db client and ID utility
- [x] 01-02-PLAN.md — Define all table schemas, relations, indexes, and TypeScript types
- [x] 01-03-PLAN.md — Push schema to Neon, seed step definitions, health check endpoint

### Phase 2: Authentication & Roles

**Goal**: Users can sign up, sign in, and access role-appropriate routes with session persistence
**Depends on**: Phase 1
**Requirements**: AUTH-01, AUTH-02, AUTH-03, AUTH-04, AUTH-05
**Plans**: 4 plans

Plans:

- [x] 02-01-PLAN.md — Install Clerk SDK, create users DB schema, configure ClerkProvider and middleware
- [x] 02-02-PLAN.md — Create Clerk webhook endpoint for user sync and role management utilities
- [x] 02-03-PLAN.md — Build auth modal components (sign-in, sign-up, auth wall)
- [x] 02-04-PLAN.md — Wire route pages, header, anonymous sessions, and verify end-to-end auth flow

### Phase 3: Application Shell

**Goal**: Complete app layout with header, sidebar, and all 10 design thinking step pages routable and visible
**Depends on**: Phase 2
**Requirements**: SCAF-01, SCAF-02, SCAF-03, SCAF-04, STEP-01, STEP-02, STEP-03
**Plans**: 6 plans

Plans:

- [x] 03-01-PLAN.md — Install deps, shadcn/ui components, configure ThemeProvider and dark mode
- [x] 03-02-PLAN.md — Create step metadata module and update middleware for workshop routes
- [x] 03-03-PLAN.md — Workshop session creation server action and landing page with Start Workshop CTA
- [x] 03-04-PLAN.md — Workshop layout with collapsible sidebar, header, exit dialog, mobile stepper
- [x] 03-05-PLAN.md — Step pages with resizable chat/output split panels and mock content
- [x] 03-06-PLAN.md — Dashboard with workshop cards, management CTAs, and end-to-end verification

### Phase 4: Navigation & State

**Goal**: Users can move forward/backward through steps with visual progress tracking and sequential enforcement
**Depends on**: Phase 3
**Requirements**: NAV-01, NAV-02, NAV-03, NAV-04, NAV-05
**Plans**: 2 plans

Plans:

- [x] 04-01-PLAN.md — Server actions for step state management and layout data fetching
- [x] 04-02-PLAN.md — Wire sidebar, mobile stepper, step navigation buttons, and sequential enforcement

### Phase 5: AI Chat Integration

**Goal**: Gemini API connected with working chat interface streaming responses at each step
**Depends on**: Phase 4
**Requirements**: CHAT-01, CHAT-02, CHAT-03, CHAT-04
**Plans**: 2 plans

Plans:

- [x] 05-01-PLAN.md — Install AI SDK, create chat_messages schema, build streaming /api/chat endpoint
- [x] 05-02-PLAN.md — Wire ChatPanel with useChat hook, load persisted messages, verify end-to-end

### Phase 6: Production Deployment

**Goal**: Application deployed to Vercel with domain configured and all services connected in production
**Depends on**: Phase 5
**Requirements**: DEPLOY-01, DEPLOY-02, DEPLOY-03
**Plans**: 2 plans

Plans:

- [x] 06-01-PLAN.md — Production hardening: error boundaries, env verification, analytics, migration config
- [x] 06-02-PLAN.md — Deploy to Vercel production, configure env vars, custom domain, end-to-end verification

## Progress

| Phase                     | Plans Complete | Status     | Completed  |
| ------------------------- | -------------- | ---------- | ---------- |
| 1. Foundation & Database  | 3/3            | Complete   | 2026-02-07 |
| 2. Authentication & Roles | 4/4            | Complete   | 2026-02-07 |
| 3. Application Shell      | 6/6            | Complete   | 2026-02-08 |
| 4. Navigation & State     | 2/2            | Complete   | 2026-02-08 |
| 5. AI Chat Integration    | 2/2            | Complete   | 2026-02-08 |
| 6. Production Deployment  | 2/2            | Complete   | 2026-02-08 |

---

## Milestone Summary

**Key Decisions:**
- neon-http driver over WebSocket (serverless-optimized)
- Prefixed CUID2 IDs (ws_, wm_, wst_, ses_, bp_, usr_) for debuggability
- Roles stored in Clerk publicMetadata (source of truth), mirrored in DB
- Modal overlays for auth (not dedicated routes)
- Workshop route protection: steps 1-3 public, 4-10 protected
- react-resizable-panels for chat/output split
- AI SDK 5 with DefaultChatTransport and sendMessage pattern
- Gemini 2.0 Flash model for cost-effective responses
- Build pipeline: verify-env → migrate → build (fail fast)

**Issues Resolved:**
- Clerk/React 19 peer dependency mismatch (.npmrc legacy-peer-deps)
- Next.js 16 middleware deprecation warning (non-blocking)
- Hydration mismatches with localStorage (useEffect pattern)
- AI SDK 5 API changes (sendMessage vs handleSubmit, originalMessages)

**Issues Deferred:**
- Workshops table deletedAt column for soft delete on user deletion
- Next.js middleware → proxy convention migration

**Technical Debt Incurred:**
- Generic AI chat (not step-specific) — addressed in MVP 1.0
- No auto-save yet — deferred to MVP 1.0
- No session persistence across browser close — deferred to MVP 1.0

---

_For current project status, see .planning/ROADMAP.md_
