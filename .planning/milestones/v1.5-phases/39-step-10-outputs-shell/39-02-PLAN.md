---
phase: 39-step-10-outputs-shell
plan: 02
type: execute
wave: 1
depends_on: ["39-01"]
files_modified:
  - src/components/workshop/step-container.tsx
autonomous: true
gap_closure: true
requirements: [OUT-01, OUT-02, OUT-03]

must_haves:
  truths:
    - "Step 10 renders SynthesisSummaryView with deliverable cards on desktop when an artifact exists"
    - "Step 10 renders SynthesisSummaryView with deliverable cards on mobile when an artifact exists"
    - "Step 10 empty state shows the synthesis placeholder text when no artifact exists"
    - "All other steps (1-9) continue to render exactly as before (no regression)"
  artifacts:
    - path: "src/components/workshop/step-container.tsx"
      provides: "Step 10 render path for SynthesisSummaryView"
      contains: "SynthesisSummaryView"
  key_links:
    - from: "src/components/workshop/step-container.tsx"
      to: "src/components/workshop/synthesis-summary-view.tsx"
      via: "import and conditional render at stepOrder === 10"
      pattern: "stepOrder.*===.*10.*SynthesisSummaryView"
---

<objective>
Wire SynthesisSummaryView into the active render tree so Step 10 deliverable cards and synthesis summary are visible to users.

Purpose: Phase 39-01 built the components (DeliverableCard, updated SynthesisSummaryView) and wired them into OutputPanel, but OutputPanel sits behind OutputAccordion which was orphaned when Phase 31 retired the output panel. The entire render chain is severed. This plan bypasses the retired OutputAccordion/OutputPanel chain by importing SynthesisSummaryView directly into step-container.tsx and rendering it for Step 10.

Output: Step 10 shows synthesis summary + Build Pack deliverable cards in the right panel area (desktop) and in the canvas tab content (mobile).
</objective>

<execution_context>
@/Users/michaelchristie/.claude/get-shit-done/workflows/execute-plan.md
@/Users/michaelchristie/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/v1.5-MILESTONE-AUDIT.md
@.planning/phases/39-step-10-outputs-shell/39-01-SUMMARY.md
@src/components/workshop/step-container.tsx
@src/components/workshop/synthesis-summary-view.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Wire SynthesisSummaryView into StepContainer for Step 10</name>
  <files>src/components/workshop/step-container.tsx</files>
  <action>
Import SynthesisSummaryView at the top of step-container.tsx:

```typescript
import { SynthesisSummaryView } from './synthesis-summary-view';
```

Step 10 ("validate") is NOT in CANVAS_ENABLED_STEPS or CANVAS_ONLY_STEPS. Currently, for non-canvas-only steps, StepContainer renders RightPanel (which wraps CanvasWrapper) in the right panel area. For Step 10 this shows a useless empty canvas. The fix replaces that with a SynthesisSummaryView render.

**Desktop layout changes (3 locations in step-container.tsx):**

There are 3 places where the right panel renders for non-CANVAS_ONLY_STEPS steps. Each uses a pattern like:

```tsx
) : (
  <RightPanel stepOrder={stepOrder} ... />
)
```

At each of these 3 locations (approximately lines 313, 225, 358), add a Step 10 check BEFORE the RightPanel fallback. The pattern becomes:

```tsx
) : stepOrder === 10 ? (
  <div className="flex h-full flex-col overflow-y-auto p-6">
    {initialArtifact ? (
      <SynthesisSummaryView artifact={initialArtifact} />
    ) : (
      <div className="flex h-full items-center justify-center rounded-lg border bg-card p-12">
        <p className="text-sm text-muted-foreground">
          Your synthesis summary and Build Pack deliverables will appear here after AI completes the review
        </p>
      </div>
    )}
  </div>
) : (
  <RightPanel stepOrder={stepOrder} ... />
)
```

The 3 desktop locations are:
1. **Both panels visible** (inside `!chatCollapsed && !canvasCollapsed` PanelGroup, around line 313) -- the `<Panel minSize="30%">` right-side panel
2. **Chat collapsed, canvas showing** (inside `chatCollapsed && !canvasCollapsed`, around line 358) -- the full-width canvas area
3. Do NOT touch the `!chatCollapsed && canvasCollapsed` section (line 326-328) -- that is when canvas is collapsed, showing only chat full-width. Step 10 content goes in the "canvas" slot, not the chat slot.

**Mobile layout changes (1 location):**

In the mobile section (inside `if (isMobile)`), the canvas tab content (around line 207-231) has the same pattern. Add the Step 10 check before RightPanel:

```tsx
<div className={cn('h-full', mobileTab !== 'canvas' && 'hidden')}>
  {step && CANVAS_ONLY_STEPS.includes(step.id) ? (
    // ... existing CanvasWrapper + ConceptCanvasOverlay ...
  ) : stepOrder === 10 ? (
    <div className="flex h-full flex-col overflow-y-auto p-6">
      {initialArtifact ? (
        <SynthesisSummaryView artifact={initialArtifact} />
      ) : (
        <div className="flex h-full items-center justify-center rounded-lg border bg-card p-12">
          <p className="text-sm text-muted-foreground">
            Your synthesis summary and Build Pack deliverables will appear here after AI completes the review
          </p>
        </div>
      )}
    </div>
  ) : (
    <RightPanel ... />
  )}
</div>
```

**Important constraints:**
- Do NOT modify OutputAccordion or OutputPanel -- they are retired code
- Do NOT add "validate" to CANVAS_ENABLED_STEPS or CANVAS_ONLY_STEPS -- Step 10 is not a canvas step
- Do NOT pass collapse button props (`onCollapse`) to the Step 10 view -- it should fill the available space naturally
- The collapse button for the right panel IS needed for desktop -- wrap the Step 10 content in a container that includes the existing collapse button pattern from RightPanel (the absolute positioned button), so the user can still collapse the right panel on desktop. Add a relative container with the collapse button above the scrollable content.
- For the "Both panels visible" case, include the collapse button. For the "Chat collapsed" case, include the collapse button. Pattern:

```tsx
) : stepOrder === 10 ? (
  <div className="h-full relative">
    {onCollapse && (
      <div className="absolute top-2 right-2 z-10">
        <button
          onClick={onCollapse}
          className="rounded-md bg-background/80 p-1 text-muted-foreground shadow-sm hover:bg-muted hover:text-foreground transition-colors"
          title="Collapse panel"
        >
          <PanelRightClose className="h-4 w-4" />
        </button>
      </div>
    )}
    <div className="flex h-full flex-col overflow-y-auto p-6">
      {initialArtifact ? (
        <SynthesisSummaryView artifact={initialArtifact} />
      ) : (
        <div className="flex h-full items-center justify-center rounded-lg border bg-card p-12">
          <p className="text-sm text-muted-foreground">
            Your synthesis summary and Build Pack deliverables will appear here after AI completes the review
          </p>
        </div>
      )}
    </div>
  </div>
) : (
```

Wait -- looking more carefully at the code, `onCollapse` is only passed to `RightPanel` in 2 of the 3 desktop locations. Let me be more precise:

Location 1 (both panels visible, line ~313): `<RightPanel ... onCollapse={() => setCanvasCollapsed(true)} />` -- YES, needs collapse button. Use `setCanvasCollapsed(true)` directly.

Location 2 (chat collapsed + canvas showing, line ~358): `<RightPanel ... onCollapse={() => setCanvasCollapsed(true)} />` -- YES, needs collapse button. Use `setCanvasCollapsed(true)` directly.

Location 3 (mobile, line ~225): No onCollapse -- mobile uses tab bar, no collapse button needed.

So for desktop locations 1 and 2, render:
```tsx
) : stepOrder === 10 ? (
  <div className="h-full relative">
    <div className="absolute top-2 right-2 z-10">
      <button
        onClick={() => setCanvasCollapsed(true)}
        className="rounded-md bg-background/80 p-1 text-muted-foreground shadow-sm hover:bg-muted hover:text-foreground transition-colors"
        title="Collapse panel"
      >
        <PanelRightClose className="h-4 w-4" />
      </button>
    </div>
    <div className="flex h-full flex-col overflow-y-auto p-6">
      {initialArtifact ? (
        <SynthesisSummaryView artifact={initialArtifact} />
      ) : (
        <div className="flex h-full items-center justify-center rounded-lg border bg-card p-12">
          <p className="text-sm text-muted-foreground">
            Your synthesis summary and Build Pack deliverables will appear here after AI completes the review
          </p>
        </div>
      )}
    </div>
  </div>
) : (
  <RightPanel ... />
)
```

For mobile (location 3), no collapse button:
```tsx
) : stepOrder === 10 ? (
  <div className="flex h-full flex-col overflow-y-auto p-6">
    {initialArtifact ? (
      <SynthesisSummaryView artifact={initialArtifact} />
    ) : (
      <div className="flex h-full items-center justify-center rounded-lg border bg-card p-12">
        <p className="text-sm text-muted-foreground">
          Your synthesis summary and Build Pack deliverables will appear here after AI completes the review
        </p>
      </div>
    )}
  </div>
) : (
  <RightPanel ... />
)
```

To avoid repetition, extract a helper function at the top of the component (inside StepContainer, before any returns):

```tsx
const renderStep10Content = () => (
  <div className="flex h-full flex-col overflow-y-auto p-6">
    {initialArtifact ? (
      <SynthesisSummaryView artifact={initialArtifact} />
    ) : (
      <div className="flex h-full items-center justify-center rounded-lg border bg-card p-12">
        <p className="text-sm text-muted-foreground">
          Your synthesis summary and Build Pack deliverables will appear here after AI completes the review
        </p>
      </div>
    )}
  </div>
);
```

Then use `renderStep10Content()` at each of the 3 locations, wrapping with collapse button container only for the 2 desktop locations.
  </action>
  <verify>
1. `npx tsc --noEmit` passes with zero errors
2. Grep confirms SynthesisSummaryView is imported in step-container.tsx: `grep "SynthesisSummaryView" src/components/workshop/step-container.tsx`
3. Grep confirms stepOrder === 10 conditional exists: `grep "stepOrder === 10" src/components/workshop/step-container.tsx`
4. Grep confirms the import path: `grep "from './synthesis-summary-view'" src/components/workshop/step-container.tsx`
5. Count occurrences: `grep -c "renderStep10Content" src/components/workshop/step-container.tsx` should show 4+ (1 definition + 3 call sites)
6. Verify no other steps affected: `grep "CANVAS_ENABLED_STEPS\|CANVAS_ONLY_STEPS" src/components/workshop/step-container.tsx` should show unchanged arrays (no "validate" added)
  </verify>
  <done>
- SynthesisSummaryView is imported in step-container.tsx
- stepOrder === 10 renders SynthesisSummaryView with initialArtifact in the right panel area (desktop, 2 locations) and canvas tab (mobile, 1 location)
- Empty state renders placeholder text when initialArtifact is null/undefined
- Desktop collapse button is preserved for the right panel
- All other steps (1-9) render identically to before (no changes to CANVAS_ENABLED_STEPS, CANVAS_ONLY_STEPS, or any non-Step-10 render paths)
- TypeScript compiles without errors
  </done>
</task>

</tasks>

<verification>
1. TypeScript: `npx tsc --noEmit` exits with zero errors
2. Render chain intact: `grep -n "SynthesisSummaryView" src/components/workshop/step-container.tsx` shows import and render usage
3. No regression: CANVAS_ENABLED_STEPS and CANVAS_ONLY_STEPS arrays unchanged
4. OutputAccordion/OutputPanel NOT touched: `git diff --name-only` shows only step-container.tsx modified
5. Build check: The pre-existing seed-workshop build error is unrelated; TypeScript compilation is the relevant check
</verification>

<success_criteria>
- SynthesisSummaryView renders in the active component tree for Step 10
- Users navigating to Step 10 with a completed synthesis artifact see: narrative, step summaries, confidence gauge, recommended next steps, AND the 4 Build Pack deliverable cards
- Users navigating to Step 10 without an artifact see a placeholder message
- Requirements OUT-01, OUT-02, OUT-03 are fully satisfied (visible to users, not just existing as code)
</success_criteria>

<output>
After completion, create `.planning/phases/39-step-10-outputs-shell/39-02-SUMMARY.md`
</output>
