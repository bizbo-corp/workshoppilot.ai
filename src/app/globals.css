@import "tailwindcss";
@import "tw-animate-css";
@plugin "@tailwindcss/typography";

@custom-variant dark (&:is(.dark *));

@theme inline {
  --color-background: var(--background);
  --color-foreground: var(--foreground);
  --font-sans: var(--font-geist-sans);
  --font-mono: var(--font-geist-mono);
  --color-sidebar-ring: var(--sidebar-ring);
  --color-sidebar-border: var(--sidebar-border);
  --color-sidebar-accent-foreground: var(--sidebar-accent-foreground);
  --color-sidebar-accent: var(--sidebar-accent);
  --color-sidebar-primary-foreground: var(--sidebar-primary-foreground);
  --color-sidebar-primary: var(--sidebar-primary);
  --color-sidebar-foreground: var(--sidebar-foreground);
  --color-sidebar: var(--sidebar);
  --color-chart-5: var(--chart-5);
  --color-chart-4: var(--chart-4);
  --color-chart-3: var(--chart-3);
  --color-chart-2: var(--chart-2);
  --color-chart-1: var(--chart-1);
  --color-ring: var(--ring);
  --color-input: var(--input);
  --color-border: var(--border);
  --color-destructive: var(--destructive);
  --color-destructive-foreground: var(--destructive-foreground);
  --color-accent-foreground: var(--accent-foreground);
  --color-accent: var(--accent);
  --color-muted-foreground: var(--muted-foreground);
  --color-muted: var(--muted);
  --color-secondary-foreground: var(--secondary-foreground);
  --color-secondary: var(--secondary);
  --color-primary-foreground: var(--primary-foreground);
  --color-primary: var(--primary);
  --color-popover-foreground: var(--popover-foreground);
  --color-popover: var(--popover);
  --color-card-foreground: var(--card-foreground);
  --color-card: var(--card);
  --radius-sm: calc(var(--radius) - 4px);
  --radius-md: calc(var(--radius) - 2px);
  --radius-lg: var(--radius);
  --radius-xl: calc(var(--radius) + 4px);

  /* Neutral-olive palette */
  --color-neutral-olive-50: var(--neutral-olive-50);
  --color-neutral-olive-100: var(--neutral-olive-100);
  --color-neutral-olive-200: var(--neutral-olive-200);
  --color-neutral-olive-300: var(--neutral-olive-300);
  --color-neutral-olive-400: var(--neutral-olive-400);
  --color-neutral-olive-500: var(--neutral-olive-500);
  --color-neutral-olive-600: var(--neutral-olive-600);
  --color-neutral-olive-700: var(--neutral-olive-700);
  --color-neutral-olive-800: var(--neutral-olive-800);
  --color-neutral-olive-900: var(--neutral-olive-900);
  --color-neutral-olive-950: var(--neutral-olive-950);

  /* Olive palette */
  --color-olive-50: var(--olive-50);
  --color-olive-100: var(--olive-100);
  --color-olive-200: var(--olive-200);
  --color-olive-300: var(--olive-300);
  --color-olive-400: var(--olive-400);
  --color-olive-500: var(--olive-500);
  --color-olive-600: var(--olive-600);
  --color-olive-700: var(--olive-700);
  --color-olive-800: var(--olive-800);
  --color-olive-900: var(--olive-900);
  --color-olive-950: var(--olive-950);
}

/* Neutral-olive palette */
:root {
  --neutral-olive-50: #f9f9f8;
  --neutral-olive-100: #ededea;
  --neutral-olive-200: #d6d7d2;
  --neutral-olive-300: #bfc1ba;
  --neutral-olive-400: #a8aaa3;
  --neutral-olive-500: #91948b;
  --neutral-olive-600: #797e73;
  --neutral-olive-700: #62675c;
  --neutral-olive-800: #4b5144;
  --neutral-olive-900: #343b2c;
  --neutral-olive-950: #293021;
}

/* Olive palette */
:root {
  --olive-50: #f9fbf6;
  --olive-100: #e8eae2;
  --olive-200: #c9d0bc;
  --olive-300: #b1bca0;
  --olive-400: #9ea88d;
  --olive-500: #8b9679;
  --olive-600: #768364;
  --olive-700: #637051;
  --olive-800: #505d3d;
  --olive-900: #3d4b29;
  --olive-950: #33421f;
}

/* Light mode — sage / olive hue */
:root {
  --radius: 0.625rem;
  /* Canvas */
  --canvas-bg: var(--neutral-olive-100);
  --canvas-dots: color-mix(in srgb, var(--foreground) 40%, transparent);
  --canvas-grid-line: var(--neutral-olive-300);
  --canvas-grid-line-light: var(--neutral-olive-200);
  --canvas-crosshair: var(--neutral-olive-500);
  --canvas-label-text: var(--neutral-olive-800);
  --canvas-label-muted: var(--neutral-olive-600);
  --canvas-label-subtle: var(--neutral-olive-400);
  --canvas-label-bg: var(--neutral-olive-100);
  --canvas-highlight-fill: #fef3c7;
  --canvas-tint-opacity: 0.06;
  --canvas-zone-opacity: 0.08;
  /* Post-it note colors — muted, olive-complementary */
  --postit-yellow: #e8d898;
  --postit-pink: #ddb8be;
  --postit-blue: #a8c0d0;
  --postit-green: #a8c8a0;
  --postit-orange: #ddc498;
  --postit-red: #d4a8a8;
  /* Mind map branch colors — desaturated, earthy */
  --mm-blue: #5a7ea0;
  --mm-blue-bg: #dce3ea;
  --mm-green: #5a9060;
  --mm-green-bg: #d6e4d0;
  --mm-purple: #7a6a98;
  --mm-purple-bg: #ddd6e6;
  --mm-orange: #a07848;
  --mm-orange-bg: #e4d9c8;
  --mm-pink: #986a78;
  --mm-pink-bg: #e2d2d6;
  --mm-yellow: #908238;
  --mm-yellow-bg: #e0dcc4;
  --mm-root: #5a6050;
  --mm-root-bg: #e0e2da;
  --background: var(--neutral-olive-100);
  --foreground: var(--neutral-olive-800);
  --card: var(--neutral-olive-50);
  --card-foreground: var(--neutral-olive-950);
  --popover: var(--neutral-olive-50);
  --popover-foreground: var(--neutral-olive-950);
  --primary: var(--neutral-olive-800);
  --primary-foreground: var(--neutral-olive-100);
  --secondary: var(--neutral-olive-200);
  --secondary-foreground: var(--neutral-olive-900);
  --muted: var(--neutral-olive-50);
  --muted-foreground: var(--neutral-olive-500);
  --accent: var(--neutral-olive-100);
  --accent-foreground: var(--neutral-olive-500);
  --destructive: #dc2626;
  --destructive-foreground: #fef2f2;
  --border: var(--neutral-olive-200);
  --input: var(--neutral-olive-200);
  --ring: var(--neutral-olive-400);
  --chart-1: rgba(234, 88, 12, 1);
  --chart-2: rgba(13, 148, 136, 1);
  --chart-3: rgba(22, 78, 99, 1);
  --chart-4: rgba(251, 191, 36, 1);
  --chart-5: rgba(245, 158, 11, 1);
  --sidebar: var(--neutral-olive-50);
  --sidebar-foreground: var(--neutral-olive-950);
  --sidebar-primary: var(--neutral-olive-900);
  --sidebar-primary-foreground: var(--neutral-olive-50);
  --sidebar-accent: var(--neutral-olive-100);
  --sidebar-accent-foreground: var(--neutral-olive-900);
  --sidebar-border: var(--neutral-olive-200);
  --sidebar-ring: var(--neutral-olive-400);
}

/* Dark mode — deep green */
.dark {
  /* Canvas */
  --canvas-bg: var(--neutral-olive-950);
  --canvas-dots: color-mix(in srgb, var(--foreground) 50%, transparent);
  --canvas-grid-line: var(--neutral-olive-800);
  --canvas-grid-line-light: var(--neutral-olive-900);
  --canvas-crosshair: var(--neutral-olive-700);
  --canvas-label-text: var(--neutral-olive-200);
  --canvas-label-muted: var(--neutral-olive-400);
  --canvas-label-subtle: var(--neutral-olive-600);
  --canvas-label-bg: var(--neutral-olive-900);
  --canvas-highlight-fill: #78350f4d;
  --canvas-tint-opacity: 0.12;
  --canvas-zone-opacity: 0.15;
  /* Post-it note colors — dark mode (higher contrast) */
  --postit-yellow: #7a6b2e;
  --postit-pink: #7a4550;
  --postit-blue: #3a5878;
  --postit-green: #3a7840;
  --postit-orange: #7a5828;
  --postit-red: #783838;
  /* Mind map branch colors — dark mode (higher contrast) */
  --mm-blue: #7ba0c0;
  --mm-blue-bg: #2e3d50;
  --mm-green: #7ab080;
  --mm-green-bg: #2c4830;
  --mm-purple: #9a8ab8;
  --mm-purple-bg: #3a3050;
  --mm-orange: #c09868;
  --mm-orange-bg: #483828;
  --mm-pink: #b88a98;
  --mm-pink-bg: #483038;
  --mm-yellow: #b0a258;
  --mm-yellow-bg: #484028;
  --mm-root: #8a9080;
  --mm-root-bg: #354030;
  --background: var(--neutral-olive-950);
  --foreground: var(--neutral-olive-200);
  --card: var(--neutral-olive-900);
  --card-foreground: var(--neutral-olive-50);
  --popover: var(--neutral-olive-800);
  --popover-foreground: var(--neutral-olive-50);
  --primary: var(--neutral-olive-100);
  --primary-foreground: var(--neutral-olive-800);
  --secondary: var(--neutral-olive-800);
  --secondary-foreground: var(--neutral-olive-50);
  --muted: var(--neutral-olive-800);
  --muted-foreground: var(--neutral-olive-400);
  --accent: var(--neutral-olive-700);
  --accent-foreground: var(--neutral-olive-400);
  --destructive: #f87171;
  --destructive-foreground: #fef2f2;
  --border: rgba(255, 255, 255, 0.1);
  --input: rgba(255, 255, 255, 0.15);
  --ring: var(--neutral-olive-500);
  --chart-1: #1d4ed8;
  --chart-2: #10b981;
  --chart-3: #f59e0b;
  --chart-4: #a855f7;
  --chart-5: #f43f5e;
  --sidebar: var(--neutral-olive-900);
  --sidebar-foreground: var(--neutral-olive-50);
  --sidebar-primary: var(--neutral-olive-100);
  --sidebar-primary-foreground: var(--neutral-olive-900);
  --sidebar-accent: var(--neutral-olive-800);
  --sidebar-accent-foreground: var(--neutral-olive-50);
  --sidebar-border: rgba(255, 255, 255, 0.1);
  --sidebar-ring: var(--neutral-olive-600);
}

@layer base {
  * {
    @apply border-border outline-ring/50;
  }
  body {
    @apply bg-background text-foreground;
  }
  html, body {
    overscroll-behavior: none;
  }
}

/* Canvas container uses dynamic viewport height for iOS Safari toolbar */
.canvas-container {
  height: 100dvh;
}

@supports not (height: 100dvh) {
  .canvas-container {
    height: 100vh;
  }
}

/* Prevent touch-action conflicts on canvas elements */
.react-flow {
  touch-action: none;
}

/* Canvas cursor overrides — ReactFlow sets cursors on internal elements,
   so we need to force-override via a parent class on the <ReactFlow> element. */
.react-flow.cursor-pointer-tool,
.react-flow.cursor-pointer-tool .react-flow__pane {
  cursor: default !important;
}

.react-flow.cursor-pointer-tool .react-flow__node {
  cursor: pointer !important;
}

.react-flow.cursor-hand-tool,
.react-flow.cursor-hand-tool .react-flow__pane {
  cursor: grab !important;
}

.react-flow.cursor-dragging,
.react-flow.cursor-dragging .react-flow__pane,
.react-flow.cursor-dragging .react-flow__node {
  cursor: grabbing !important;
}

/* Miro-like drag lift — clean elevated shadow, no ghost trail */
.react-flow__node.dragging {
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.18), 0 2px 6px rgba(0, 0, 0, 0.08);
  transition: none !important;
}

/* Canvas background — set on .react-flow so the dot grid (z-index -1 → 2)
   renders above overlays (z-1) but below nodes (z-4 renderer). */
.react-flow {
  background-color: var(--canvas-bg);
}

/* Raise dot grid above overlays so dots are visible through tinted fills */
.react-flow__background {
  z-index: 2 !important;
  background-color: transparent !important;
}
